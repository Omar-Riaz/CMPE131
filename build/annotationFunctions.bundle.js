!function(n){var e={};function t(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return n[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}t.m=n,t.c=e,t.d=function(n,e,o){t.o(n,e)||Object.defineProperty(n,e,{enumerable:!0,get:o})},t.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},t.t=function(n,e){if(1&e&&(n=t(n)),8&e)return n;if(4&e&&"object"==typeof n&&n&&n.__esModule)return n;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:n}),2&e&&"string"!=typeof n)for(var r in n)t.d(o,r,function(e){return n[e]}.bind(null,r));return o},t.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(e,"a",e),e},t.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},t.p="",t(t.s=6)}({6:function(n,e,t){"use strict";t.r(e),e.default=function(){return{createContextMenus:function(){chrome.contextMenus.create({type:"normal",id:"1",contexts:["selection"],title:"ReMedia: annotate selection"})},registerEvents:function(){chrome.tabs.onUpdated.addListener(function(n,e,t){new Promise(function(n,e){chrome.tabs.query({active:!0,currentWindow:!0},function(e){n(e[0].id)})}).then(function(n){n=n,chrome.tabs.sendMessage(n,{contentType:"create"},function(n){n&&console.log(n)})})}),chrome.contextMenus.onClicked.addListener(function(){preSaveAnnotation(null)})},getCurrentTabUrl:function(){var n={active:!0,currentWindow:!0};return new Promise(function(e,t){chrome.tabs.query(n,function(n){var t=n[0].url;console.assert("string"==typeof t,"tab.url should be a string"),e(t)})})},loadQuote:function(){return new Promise(function(n,e){chrome.tabs.executeScript({code:"document.getSelection().toString()"},function(e){console.log(e[0]),n(e[0])})})},performAnnotate:function(){return prompt("enter your annotation")},getSavedAnnotations:function(n){return new Promise(function(e,t){console.log(n),chrome.storage.sync.get(n,function(t){e(chrome.runtime.lastError?null:t[n])})})},save:function(n,e,t){if(n&&e){var o,r,u,i=(u={annotation:e,channels:t,quote:n},(r=n)in(o={})?Object.defineProperty(o,r,{value:u,enumerable:!0,configurable:!0,writable:!0}):o[r]=u,o);console.log(i),chrome.storage.sync.set(i)}},getAnnotationObjModel:function(n,e,t){var o={};return o.quote=e,o.annotation=t,o},setQuoteObj:function(){},loadQuotes:function(n){chrome.storage.sync.get(null,function(e){return e.filter(function(e){if(e.url===n)return e})})},saveQuote:function(n,e,t,o){var r={};r[e]={url:n,annotation:t,channels:o},chrome.storage.sync.set(r)},saveChannels:function(n){var e={};e.channels={channels:n},chrome.storage.sync.set(e)},saveQuoteStateModel:function(n,e,t){var o={};return o[e]={url:n,annotation:t},o},preSaveAnnotation:function(){var n,e="";getCurrentTabUrl().then(function(t){n=t,loadQuote().then(function(n){e=n}),getSavedAnnotations(n)}).then(function(t){saveAnnotation(n,e,void 0),console.log("about to render modal"),new Promise(function(n,e){chrome.tabs.query({active:!0,currentWindow:!0},function(e){n(e[0].id)})}).then(function(t){chrome.tabs.sendMessage(t,{contentType:"url",quoteText:e,url:n},function(n){n&&console.log(n)})})})},findAnnotation:function(n){return annotationFunctions.getSavedAnnotations().filter(function(e){if(e.quoteText===n)return e})[0]}}}}});